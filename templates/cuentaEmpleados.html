<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Empleados | Yadmandul store</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="{{url_for('static', filename='css/inicioSesion.css')}}"
    />
    <link
      rel="icon"
      href="{{url_for('static', filename='assets/img/logo_definitivo.png')}}"
      type="image/png"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/style.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/stylesCuenta.css')}}"
    />
    <link
      rel="stylesheet"
      href="{{url_for('static', filename='css/styleAdmins.css')}}"
    />
    <script
      src="https://kit.fontawesome.com/ecae724dfb.js"
      crossorigin="anonymous"
    ></script>
    <style>
      .dropdown {
        position: relative;
        display: inline-block;
      }

      #order-status {
        display: none;
        position: absolute;
        min-width: 160px;
        z-index: 1;
      }

      .dropdown:hover #order-status {
        display: block;
      }

      .aviso-exito,
      .aviso-fracaso {
        top: 10%;
      }
    </style>
  </head>
  <body>
    <div class="aviso-exito">
      <h1>Aviso</h1>
      <p>Modificación completada con éxito</p>
      <a id="close-aviso-exito">Cerrar</a>
    </div>
    <div class="aviso-fracaso">
      <h1>Aviso</h1>
      <p>Error para completar la modificación</p>
      <a id="close-aviso-fracaso">Cerrar</a>
    </div>
    <header>
      <div class="title-container">
        <a href="#"
          ><img
            src="{{url_for('static', filename='assets/img/logo_definitivo.png')}}"
            alt="logo"
        /></a>
        <p>EMPLEADO {{user.name}} | Yadmandul store</p>
      </div>
      <nav>
        <ul>
          <li>
            <a href="/logout">
              <i class="fa-solid fa-right-from-bracket"></i
              >&nbsp;&nbsp;&nbsp;Cerrar sesión
            </a>
          </li>
        </ul>
      </nav>
    </header>
    <aside>
      <nav>
        <ul>
          <li>
            <a href="#" id="btn-profile"
              ><i class="fa-solid fa-user"></i>&nbsp;&nbsp;&nbsp;Mi perfil</a
            >
          </li>
          <li>
            <div class="dropdown">
              <a href="#" id="btn-employees">
                <i class="fa-solid fa-clipboard-list"></i
                >&nbsp;&nbsp;&nbsp;Pedidos
              </a>
              <select id="order-status">
                <option value="none">-- Seleccione --</option>
                <option value="pending">Pedidos pendientes</option>
                <option value="cancelled">Pedidos cancelados</option>
                <option value="completed">Pedidos completados</option>
              </select>
            </div>
          </li>
          <li>
            <a href="#" id="btn-clients"
              ><i class="fa-solid fa-cookie-bite" style="font-size: 0.7em"></i
              >&nbsp;&nbsp;Productos</a
            >
          </li>
        </ul>
      </nav>
    </aside>
    <main>
      <div class="user-data">
        <img
          src="{{url_for('static', filename=user.photo)}}"
          alt="{{user.name}}"
        /><br />
        <form
          action="/upload_img_employee"
          ,
          method="POST"
          ,
          id="form-modify_photo_employee"
        >
          <input type="file" accept="image/*" name="photo" />
          <input type="submit" value="Cambiar foto" id="btn-change-photo" />
        </form>
        <h2>{{user.name}}</h2>
        <h3>{{user.correo}}</h3>
        <div class="user-modify-data">
          <form
            action="/modify_name_employee"
            method="POST"
            id="form-modify_name_employee"
          >
            <div class="name-container">
              <h4>
                <i class="fa-solid fa-signature"></i>&nbsp;&nbsp;&nbsp;Nombre
              </h4>
              <input type="text" placeholder="{{user.name}}" name="name" />
              <input type="submit" value="Modificar" />
            </div>
          </form>
          <form
            action="/modify_appat_employee"
            ,
            method="POST"
            ,
            id="form-modify_appat_employee"
          >
            <div class="name-container">
              <h4>
                <i class="fa-solid fa-signature"></i>&nbsp;&nbsp;&nbsp;Apellido
                paterno
              </h4>
              <input type="text" placeholder="{{user.ap_pat}}" name="appat" />
              <input type="submit" value="Modificar" />
            </div>
          </form>
          <form
            action="/modify_apmat_employee"
            ,
            method="POST"
            ,
            id="form-modify_apmat_employee"
          >
            <div class="name-container">
              <h4>
                <i class="fa-solid fa-signature"></i>&nbsp;&nbsp;&nbsp;Apellido
                materno
              </h4>
              <input type="text" placeholder="{{user.ap_mat}}" name="apmat" />
              <input type="submit" value="Modificar" />
            </div>
          </form>
          <form
            action="/modify_correo_employee"
            ,
            method="POST"
            ,
            id="form-modify_correo_employee"
          >
            <div class="name-container">
              <h4>
                <i class="fa-solid fa-envelope"></i>&nbsp;&nbsp;&nbsp;Correo
                electrónico
              </h4>
              <input
                type="email"
                placeholder="{{user.correo}}"
                name="correo"
                id="email-employee"
              />
              <input type="submit" value="Modificar" />
            </div>
          </form>
          <form
            action="/modify_password_employee"
            ,
            method="POST"
            ,
            id="form-modify_password_employee"
          >
            <div class="name-container">
              <h4><i class="fa-solid fa-key"></i>&nbsp;&nbsp;&nbsp;Password</h4>
              <input type="password" name="password" />
              <input type="submit" value="Modificar" />
            </div>
          </form>
        </div>
      </div>
      <div class="employees-container">
        <!--Pedidos-->
        <div class="welcome-employees-container">
          <h1>Pedidos</h1>
          <p>Selecciona una opción para ver los pedidos</p>
        </div>

        <div class="pending-employees-container">
          <h1>Pedidos pendientes</h1>
        </div>

        <div class="cancelled-employees-container">
          <h1>Pedidos cancelados</h1>
        </div>

        <div class="completed-employees-container">
          <h1>Pedidos completados</h1>
        </div>
      </div>
      <div class="clients-container">
        <!--Productos-->
        <h1>Productos</h1>
        <h2>Registro de productos</h2>
        <form action="/insert_products" method="POST" id="form-insert_products">
          <label>Nombre del producto</label>
          <input type="text" name="nom_prod" required /><br />
          <label>Tipo</label>
          <select name="tipo_prod">
            {% for tipo in tipos_prod %}
            <option value="{{ tipo }}">{{ tipo }}</option>
            {% endfor %}</select
          ><br />
          <label>Precio</label>
          <input type="number" name="precio_prod" required /><br />
          <label>Cantidad</label>
          <input type="number" name="cantidad_prod" required /><br />
          <label>ID del proveedor</label>
          <select name="id_prov">
            {% for proveedor in proveedores %}
            <option value="{{ proveedor[0] }}">
              {{ proveedor.0 }} -> {{proveedor.1}}
            </option>
            {% endfor %}</select
          ><br />
          <label>Foto</label>
          <input
            type="file"
            accept="image/*"
            name="foto_prod"
            id="#change-photo"
            required
          />
          <input
            type="submit"
            value="Registrar"
            style="margin-top: 10px; margin-bottom: 10px"
          />
        </form>
        <input type="search" id="buscar_prod" placeholder="Buscar" />
        <input type="checkbox" id="mostrarActivos_prod" checked />Mostrar
        activos
        <input type="checkbox" id="mostrarInactivos_prod" checked />Mostrar
        inactivos
        <table>
          <tr>
            <th>ID</th>
            <th>Proveedor</th>
            <th>Foto</th>
            <th>Producto</th>
            <th>Tipo</th>
            <th>Precio</th>
            <th>Cantidad</th>
            <th>Modificar</th>
            <th>Acción</th>
          </tr>
          {% for producto in productos %}
          <tr
            class="{{ 'activo' if producto.7 else 'inactivo' }}"
            data-nombre-prod="{{ producto.3 }}"
          >
            <form
              action="{{url_for('modify_prod', id=producto.0)}}"
              method="POST"
              id="form-modify_prod"
              data-id="{{producto.0}}"
              enctype="multipart/form-data"
            >
              <td>{{producto.0}}</td>
              <td>
                <select name="id_prov">
                  {% for proveedor in proveedores %} <option value="{{
                  proveedor[0] }}" {% if proveedor == producto.1 %}selected{%
                  endif %}> {{ proveedor.0 }} -> {{proveedor.1}} {% endfor %}
                </select>
              </td>
              <td>
                <img
                  src="{{url_for('static', filename=producto.2)}}"
                  alt="Foto del producto"
                  width="100px"
                  height="150px"
                />
                <input
                  type="file"
                  accept="image/*"
                  name="foto_prod"
                  id="#change-photo"
                />
              </td>
              <td>
                <input type="text" value="{{producto.3}}" name="nom_prod" />
              </td>
              <td>
                <select name="tipo_prod">
                  {% for tipo in tipos_prod %} <option value="{{ tipo }}" {% if
                  tipo == producto.4 %}selected{% endif %}> {{ tipo }} {% endfor
                  %}
                </select>
              </td>
              <td>
                <input
                  type="number"
                  value="{{producto.5}}"
                  name="precio_prod"
                />
              </td>
              <td>
                <input
                  type="number"
                  value="{{producto.6}}"
                  name="cantidad_prod"
                />
              </td>
              <td>
                <input type="submit" value="Modificar" />
              </td>
            </form>
            <td>
              {% if producto.7 %}
              <form
                action="{{ url_for('dar_de_baja_prod', id=producto[0]) }}"
                method="POST"
              >
                <input type="submit" value="Dar de baja" />
              </form>
              {% else %}
              <form
                action="{{ url_for('dar_de_alta_prod', id=producto[0]) }}"
                method="POST"
              >
                <input type="submit" value="Dar de alta" />
              </form>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </table>
      </div>
    </main>
    <script>
      const $btnProfile = document.getElementById("btn-profile");
      const $btnEmployees = document.getElementById("btn-employees");
      const $btnClients = document.getElementById("btn-clients");
      const $employeesContainer = document.querySelector(
        ".employees-container"
      );
      const $userData = document.querySelector(".user-data");
      const $clientsContainer = document.querySelector(".clients-container");
      function profile() {
        $userData.style.display = "block";
        $employeesContainer.style.display = "none";
        $clientsContainer.style.display = "none";
        $btnProfile.classList.add("btn-aside-active");
        $btnEmployees.classList.remove("btn-aside-active");
        $btnClients.classList.remove("btn-aside-active");
      }
      window.onload = profile;
      $btnProfile.addEventListener("click", () => {
        $userData.style.display = "block";
        $employeesContainer.style.display = "none";
        $clientsContainer.style.display = "none";
        //$ordersContainer.style.display = "none";
        $btnProfile.classList.add("btn-aside-active");
        // $main.classList.remove("main-purchases");
        // $main.classList.add("main-user-data");
        $btnEmployees.classList.remove("btn-aside-active");
        $btnProfile.classList.add("btn-aside-active:hover");
        $btnEmployees.classList.remove("btn-aside-active:hover");
        $btnClients.classList.remove("btn-aside-active");
        $btnClients.classList.remove("btn-aside-active:hover");
        //$btnOrders.classList.remove("btn-aside-active");
      });
      $btnEmployees.addEventListener("click", () => {
        $userData.style.display = "none";
        $clientsContainer.style.display = "none";
        $employeesContainer.style.display = "block";
        //$ordersContainer.style.display = "none";
        $btnProfile.classList.remove("btn-aside-active");
        $btnEmployees.classList.add("btn-aside-active");
        $btnClients.classList.remove("btn-aside-active");
        // $main.classList.remove("main-user-data");
        // $main.classList.add("main-purchases");
        $btnProfile.classList.remove("btn-aside-active:hover");
        $btnEmployees.classList.add("btn-aside-active:hover");
        $btnClients.classList.remove("btn-aside-active:hover");
        //$btnOrders.classList.remove("btn-aside-active");
      });
      $btnClients.addEventListener("click", () => {
        $userData.style.display = "none";
        $employeesContainer.style.display = "none";
        $clientsContainer.style.display = "block";
        //$ordersContainer.style.display = "none";
        $btnProfile.classList.remove("btn-aside-active");
        $btnEmployees.classList.remove("btn-aside-active");
        $btnClients.classList.add("btn-aside-active");
        // $main.classList.remove("main-user-data");
        // $main.classList.add("main-purchases");
        $btnProfile.classList.remove("btn-aside-active:hover");
        $btnEmployees.classList.remove("btn-aside-active:hover");
        $btnClients.classList.add("btn-aside-active:hover");
        //$btnOrders.classList.remove("btn-aside-active");
      });
    </script>
    <script>
      const $selectElement = document.getElementById("order-status");
      const $welcome = document.querySelector(".welcome-employees-container");
      const $pending = document.querySelector(".pending-employees-container");
      const $cancelled = document.querySelector(
        ".cancelled-employees-container"
      );
      const $completed = document.querySelector(
        ".completed-employees-container"
      );

      $pending.style.display = "none";
      $cancelled.style.display = "none";
      $completed.style.display = "none";

      $selectElement.addEventListener("change", function () {
        if (this.value === "none") {
          $welcome.style.display = "block";
          $pending.style.display = "none";
          $cancelled.style.display = "none";
          $completed.style.display = "none";
        } else if (this.value === "pending") {
          $welcome.style.display = "none";
          $pending.style.display = "block";
          $cancelled.style.display = "none";
          $completed.style.display = "none";
        } else if (this.value === "cancelled") {
          $welcome.style.display = "none";
          $pending.style.display = "none";
          $cancelled.style.display = "block";
          $completed.style.display = "none";
        } else if (this.value === "completed") {
          $welcome.style.display = "none";
          $pending.style.display = "none";
          $cancelled.style.display = "none";
          $completed.style.display = "block";
        }
      });
    </script>
    <script src="{{url_for('static', filename='js/scriptFotoPerfil.js')}}"></script>
    <script
      src="{{url_for('static', filename='js/main_modify_employee.js')}}"
      type="module"
    ></script>
    <script>
      document
        .getElementById("#change-photo")
        .addEventListener("change", function (e) {
          let reader = new FileReader();
          reader.onload = (event) => {
            document.querySelector(".clients-container img").src =
              event.target.result;
          };
          reader.readAsDataURL(e.target.files[0]);
        });
    </script>
    <script
      src="{{url_for('static', filename='js/main_filter_prod.js')}}"
      type="module"
    ></script>
  </body>
</html>
